# 実務で重要なパターン（まとめ）

## 関心の分離

- **core** … ルール・計算（UI 非依存）
- **store** … 状態とアクションの集約
- **pages / components** … 表示とユーザー入力
- **hooks** … 接続・副作用の再利用

「どこに何を書くか」を決めておくと、変更時の影響範囲が分かりやすい。

## 型でドメインを表現する

- `GameState`, `Player`, `TileInstance`, `GamePhase` などで「麻雀という世界」の用語を型にしている。
- 実務では **ビジネス用語をそのまま型名・プロパティ名にすると**、コードと仕様の対応が取りやすい。

## 単方向データフロー

- ユーザー操作 → ストアのアクション → core で新状態計算 → ストア更新 → 再レンダー。
- データの流れが一方向なので、バグの原因を「どこで状態が変わったか」で追いやすい。

## 純粋関数としてのゲームエンジン

- `processTsumo(state) => newState` のように、同じ state を渡せば同じ結果になる。
- 副作用（API や DOM）を持たないので、テストが書きやすく、将来のリプレイや AI 対戦の拡張にも有利。

## 環境変数と設定

- フロントは `VITE_` 付きの変数がクライアントに露出。サーバー URL などは `import.meta.env.VITE_SERVER_URL` で参照。
- 本番と開発で切り替えやすいように、設定は環境変数に寄せる。
