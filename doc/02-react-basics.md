# React の重要概念（本PJで使っている部分）

## コンポーネント

UI を「部品」に分けたもの。本PJでは **関数コンポーネント** のみ使用。

```tsx
export const GamePage: React.FC = () => { ... };
```

- コンポーネントは **props** でデータを受け取り、**JSX** で UI を返す。
- ファイルは `PascalCase.tsx`（例: `GamePage.tsx`, `ActionBar.tsx`）。

## Hooks

関数コンポーネント内で「状態」や「副作用」を扱う API。本PJでよく使っているもの:

| Hook | 役割 | 使用例 |
|------|------|--------|
| `useState` | コンポーネント内の状態 | モーダル表示フラグ、選択中の牌 |
| `useEffect` | マウント・更新時の副作用 | Socket の購読、ゲーム終了時の画面遷移 |
| `useCallback` | 関数の参照を安定させる | イベントハンドラを子に渡すとき |
| `useRef` | 描画に使わない「入れ物」 | Socket インスタンス、前回 phase の比較 |
| カスタムフック | ロジックの再利用 | `useGameStore`, `useSocket` |

## 状態の持ち方

- **ローカル状態** … その画面だけの UI 状態は `useState`（例: モーダル開閉、チー選択の開閉）。
- **グローバル状態** … ゲーム全体は **Zustand**（`useGameStore`）で一箇所に集約。
- 「どこに状態を置くか」を決めることが設計の中心の一つ。

## 再レンダー

- コンポーネントは **state や props が変わったとき** に再レンダーされる。
- Zustand では `useGameStore(s => s.gameState)` のように **必要なスライスだけ** を選ぶと、`gameState` が変わったときだけそのコンポーネントが再レンダーされ無駄が減る（selector パターン）。

## 子へのコールバック

- 親から子に「打牌する」「リーチする」などの **アクション** を渡すときは、関数（コールバック）を props で渡す。
- その関数は `useCallback` で包むと、依存が変わらない限り同じ参照になり、子の不要な再レンダーを抑えられる。

## メモ（実務で意識すること）

- **表示とロジックを分ける** … ゲームルールは `core/`、表示は `components/` に分離している。
- **props の型を書く** … コンポーネントの props に interface を付けると使い方の意図が明確になる。
- **Hooks のルール** … トップレベルでだけ Hooks を呼ぶ。条件分岐やループの中で呼ばない。
